// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.24;

import {Script} from "forge-std/Script.sol";
import {IERC20} from "forge-std/interfaces/IERC20.sol";
import {console} from "forge-std/console.sol";

import {IBridge} from "src/IBridge.sol";
import {NetworkId} from "src/EnumNetworkIds.sol";
import {LibClaimer} from "src/LibClaimer.sol";
import {Mainnet, Testnet} from "src/LibConstants.sol";

// https://etherscan.io/tx/0xe2bd8f6a99cf1466f10ea8abd3cef9a7e2afa2db42e320b69e2f6dc8820f2ea9#eventlog
//
// export RPC=https://zkevm-rpc.com/
// forge script script/ClaimMessage.s.sol:ClaimMessage --rpc-url ${RPC} -vvvvv
// forge script script/ClaimMessage.s.sol:ClaimMessage --rpc-url ${RPC} -vvvvv --broadcast
contract ClaimMessage is Script {
    function run() public {
        NetworkId originNetwork = NetworkId.Ethereum;
        NetworkId destinationNetwork = NetworkId.PolygonZkEVM;
        address originAddr = 0x49dC846d5EDA92dDC4985b7B7BBaD4F9b05B7597;
        address destinationAddr = 0x9bcC5F7560B243E37e0Adf8379FA6D9AB49a425b;
        uint256 depositCount = 191933;
        string[32] memory localProofHexStrings = [
            hex"2592719079f313c6b14a4ebc3d0c0f807c25feecc5a70dd23886103e461986a1",
            hex"c4619d3b2e888680d7d8e03be3b3295c393cbc5872e27bee0f64a7cd9a66b49f",
            hex"407dbbbc20c30178630feaabaee50e3a4bd1b8ccd5db060d9fd8ef08f1ff5d47",
            hex"e69d3378423797abfac875ad969214f159f1804ff09e283d5d8b9ffd5e313b04",
            hex"9fd6000368d343beb92b61e1909967cb91c0199e0dddff9ce48cdd6b67f0d34e",
            hex"9cd111f62c21749ae1d888c98136fe7cab0a941b30e3588bb32578a8e4e61b96",
            hex"17f6cc50945f857fbbed11ed89be3ed002ce945385fc4d4cfdecf9d0de119142",
            hex"9a69e31e10a04f6851c2fa0a6335150ebbf35d385d9c599f1d7d372228606193",
            hex"f452c4e439f10d9d7c4e9ed5b00d76222d7e18a49e1587e51c8f425105e94e55",
            hex"97d83fbb59aced30beee4657d065721fa8368769676ba6c37c4bd5496e9b90f5",
            hex"fc06a09aa2c0deb919191dcf4e489145627dd92331aea5a2eb3cc6f9a6da715b",
            hex"768c154afdd1610dd8af699316f604856f28473fff0aea3df255a1f98ca831e1",
            hex"ce6bf6e050768476f7abed3f886e786d4f7c4f863fbe488178acfc662c1dadbd",
            hex"5136341b2745ac90e88cae59b0ab2a037b953ce49ead59a28fea67a247d69552",
            hex"06af6b9df18b95ef84c6d2c2ba131ad89003d5be47b6a96043028e22fb1c3ce8",
            hex"a5264b93e3b3779e392e44bc1e4edacc2c298eb275a9fc054e78a34576540149",
            hex"2733e50f526ec2fa19a22b31e8ed50f23cd1fdf94c9154ed3a7609a2f1ff981f",
            hex"361122b4b1d18ab577f2aeb6632c690713456a66a5670649ceb2c0a31e43ab46",
            hex"5a2dce0a8a7f68bb74560f8f71837c2c2ebbcbf7fffb42ae1896f13f7c7479a0",
            hex"b46a28b6f55540f89444f63de0378e3d121be09e06cc9ded1c20e65876d36aa0",
            hex"c65e9645644786b620e2dd2ad648ddfcbf4a7e5b1a3a4ecfe7f64667a3f0b7e2",
            hex"f4418588ed35a2458cffeb39b93d26f18d2ab13bdce6aee58e7b99359ec2dfd9",
            hex"5a9c16dc00d6ef18b7933a6f8dc65ccb55667138776f7dea101070dc8796e377",
            hex"4df84f40ae0c8229d0d6069e5c8f39a7c299677a09d367fc7b05e3bc380ee652",
            hex"cdc72595f74c7b1043d0e1ffbab734648c838dfb0527d971b602bc216c9619ef",
            hex"0abf5ac974a1ed57f4050aa510dd9c74f508277b39d7973bb2dfccc5eeb0618d",
            hex"b8cd74046ff337f0a7bf2c8e03e10f642c1886798d71806ab1e888d9e5ee87d0",
            hex"838c5655cb21c6cb83313b5a631175dff4963772cce9108188b34ac87c81c41e",
            hex"662ee4dd2dd7b2bc707961b1e646c4047669dcb6584f0d8d770daf5d7e7deb2e",
            hex"388ab20e2573d171a88108e79d820e98f26c0b84aa8b2f4aa4968dbb818ea322",
            hex"93237c50ba75ee485f4c22adf2f741400bdf8d6a9cc7df7ecae576221665d735",
            hex"8448818bb4ae4562849e949e17ac16e0be16688e156b5cf15e098c627c0056a9"
        ];
        string[32] memory rollupProofHexStrings = [
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000",
            hex"0000000000000000000000000000000000000000000000000000000000000000"
        ];

        vm.startBroadcast(vm.envUint("DEPLOYER_PRIVATE_KEY"));
        IBridge(Mainnet.BRIDGE).claimMessage(
            LibClaimer.convertToProofArray(localProofHexStrings),
            LibClaimer.convertToProofArray(rollupProofHexStrings),
            LibClaimer.computeGlobalIndex(originNetwork, depositCount),
            bytes32(bytes(hex"37257fd9d733d5d75236241b360e516809733a0583b099af0c6de3123d510eb1")), // mainnetExitRoot
            bytes32(bytes(hex"051eb3b0b6fb73d2134f822a526a2b0bc0da54f85d75beff9bd0979f00d49f8c")), // rollupExitRoot
            uint32(originNetwork),
            originAddr,
            uint32(destinationNetwork),
            destinationAddr,
            0, // amount
            bytes(
                hex"00000000000000000000000000000000000000000000000000000000000000200000000000000000000000006b175474e89094c44da98b954eedeac495271d0f0000000000000000000000008f065f3f2db9dc6910d6a708edb55af10a7b4400000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000000e44616920537461626c65636f696e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034441490000000000000000000000000000000000000000000000000000000000"
            ) // metadata
        );
        vm.stopBroadcast();
    }
}
